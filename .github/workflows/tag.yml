name: Tag
on:
  push:
    tags: ["**"]
jobs:
  tag:
    runs-on: ubuntu-latest
    env:
      IMAGE: europe-docker.pkg.dev/arikkfir/public/syncer
    steps:
      - name: Pull image
        run: docker pull ${IMAGE}:${GITHUB_SHA}
      - name: Retag image
        run: docker tag ${IMAGE}:${GITHUB_SHA} ${IMAGE}:${GITHUB_REF/refs\/tags\//}
      - name: Push image
        run: docker push ${IMAGE}:${GITHUB_REF/refs\/tags\//}
